#                       第一章  网络安全基础

##      基于 VirtualBox 的网络攻防基础环境搭建

### 实验目的

- 掌握 VirtualBox 虚拟机的安装与使用；
- 掌握 VirtualBox 的虚拟网络类型和按需配置；
- 掌握 VirtualBox 的虚拟硬盘多重加载；

### 实验环境

以下是本次实验需要使用的网络节点说明和主要软件举例：

- VirtualBox 虚拟机
- 攻击者主机（Attacker）：Kali Rolling 2109.2
- 网关（Gateway, GW）：Debian Buster
- 靶机（Victim）：From Sqli to shell / xp-sp3 / Kali

### 实验要求

- 虚拟硬盘配置成多重加载，效果如下图所示；

![vb-multi-attach](img\vb-multi-attach.png)

- 搭建满足如下拓扑图所示的虚拟机网络拓扑；

![vb-exp-layout](img\vb-exp-layout.png)

> 根据实验宿主机的性能条件，可以适度精简靶机数量

- 完成以下网络连通性测试；
  - [x] 靶机可以直接访问攻击者主机
  - [x] 攻击者主机无法直接访问靶机
  - [x] 网关可以直接访问攻击者主机和靶机
  - [x] 靶机的所有对外上下行流量必须经过网关
  - [x] 所有节点均可以访问互联网



### 实验报告正文内容

1. 虚拟硬盘配置成多重加载

   在VirtualBox管理器中的 “管理→虚拟介质管理” 中，选择虚拟硬盘。

   在虚拟硬盘的“属性”界面下，选择虚拟硬盘的“类型”——“多重加载”。

   在设置修改完成后点击应用即可，如下图所示

   <img src="img\2021-09-08-154133.png" alt="2021-09-08-154133" style="zoom: 40%;" />

   注：该操作会令磁盘与已经建立联系的虚拟电脑解除联系，在使用这些虚拟电脑时还需要重新建立联系

   此时的VirtualBox管理器中也可以看到

   <img src="img\2021-09-08-155848.png" alt="2021-09-08-155848" style="zoom:25%;" />

2. 搭建符合要求的虚拟网络拓扑

   - 设置网关（gateway）

   新建debian虚拟电脑，依次配置其四块网卡。

   > 网卡1为NAT网络；

   > 网卡2为host-only网络，用于与主机连接以便操作，但也可以不设置；

   > 网卡3和网卡4设置为名称不同的内部网络intnet，用以连接后续的不同主机

   配置好的网卡（gateway）如下所示：

   <img src="img\2021-09-08-163308.png" alt="2021-09-08-163308" style="zoom:25%;" />

   在网络中查看网络的详细信息，检查连接情况——一切正常

   <img src="img\2021-09-08-163739.png" alt="2021-09-08-163739" style="zoom:25%;" />

   <img src="img\2021-09-08-163758.png" alt="2021-09-08-163758" style="zoom:25%;" />

   <img src="img\2021-09-08-163816.png" alt="2021-09-08-163816" style="zoom:25%;" />

   <img src="img\2021-09-08-163832.png" alt="2021-09-08-163832" style="zoom:25%;" />

   以及Host-Only网络配置

   <img src="img\2021-09-08-163921.png" alt="2021-09-08-163921" style="zoom:25%;" />

   

   配置“/etc/network/interfaces”，内容如下：

   <img src="img\2021-09-08-233612.png" alt="2021-09-08-233612" style="zoom:25%;" />

   （这里由于是导入的虚拟电脑，所以初始的配置文件就是这样，普通虚拟电脑还需要自行编写这一部分配置）

   - 

3. 连通性测试